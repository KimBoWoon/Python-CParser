

#include <iostream>
#include <fstream>
using namespace std;

int x_queue[1000]={0,};
int y_queue[1000]={0,};
int front=0,rear=0;
int cnt=0;
void x_push(int x);
void y_push(int y);
int x_pop();
int y_pop();

int main(){
	ifstream inFile("input.txt"); 
	int no_case = 0;
	inFile >> no_case; 
	for (int itr = 0; itr < no_case; itr++){
		int row=0,col=0; 
		char map[105][105]={0,};
		int visit[105][105]={0,};
		int arr[100]={0,};
		inFile>>col>>row;
		cnt =1;
		for(int i=0; i<row; i++){ 
			for(int j=0; j<col; j++){
				inFile>>map[i][j];
			}
		}
		for(int k=0; k<100; k++){ 
			int flag=0,x=0,y=0;;
			front=0,rear=0;
			for(int l=0; l<1000; l++){
				x_queue[l]=0;
				y_queue[l]=0;
			}
			for(int i=0; i<row; i++){
			
				for(int j=0; j<col; j++){
					if(map[i][j]=='.' && visit[i][j]==0){
						x_push(i);
						y_push(j);
						visit[i][j]=cnt;
						flag=1;
						break;
					}	 
				}
				if(flag==1)
					break;
			}
			if(flag==0) 
				break;
			int room_cnt=0; 
			while(1){
				if(front==rear)
					break;
				x=x_pop();
				y=y_pop();
				room_cnt++; 
				if(0<=x-1 && x-1<row && 0<=y && y<col && map[x-1][y]=='.' && visit[x-1][y]==0){
					x_push(x-1);
					y_push(y);
					visit[x-1][y]=cnt;
				}
				if(0<=x+1 && x+1<row && 0<=y && y<col && map[x+1][y]=='.' && visit[x+1][y]==0){
					x_push(x+1);
					y_push(y);
					visit[x+1][y]=cnt;
				}
				if(0<=x && x<row && 0<=y-1 && y-1<col && map[x][y-1]=='.' && visit[x][y-1]==0){
					x_push(x);
					y_push(y-1);
					visit[x][y-1]=cnt;
				}
				if(0<=x && x<row && 0<=y+1 && y+1<col && map[x][y+1]=='.' && visit[x][y+1]==0){
					x_push(x);
					y_push(y+1);
					visit[x][y+1]=cnt;
				}
			}
			arr[cnt-1]=room_cnt;
			cnt++;
			
		}
		cnt--;
		int tmp=0;
		for(int i=0; i<cnt; i++){ 
			for(int j=i; j<cnt-1; j++){
				if(arr[i]<arr[j+1]){
					tmp=arr[i];
					arr[i]=arr[j+1];
					arr[j+1]=tmp;
				}
			}
			
		}
		cout<<cnt<<endl;
		for(int i=0; i<cnt; i++)
			cout<<arr[i]<<" ";
		cout<<endl;
	}
	return 0;
}
void x_push(int x){
	x_queue[rear]=x;
}
void y_push(int y){
	y_queue[rear++]=y;
}
int x_pop(){
	return x_queue[front];
}
int y_pop(){
	return y_queue[front++];
}