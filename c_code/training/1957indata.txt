#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define W(S, A) S*S/(S*S+A*A)
#define WIN 0
#define LOSE 1
#define Wdata 2

float FindMax(float *arr, int arrLen)
{
	int i;
	float max = -1;

	for(i=1 ;i<=arrLen ;++i) 
		max = max >= arr[i] ? max : arr[i];

	return max;
}

float FindMin(float *arr, int arrLen)
{
	int i;
	float min = 20000;

	for(i=1 ;i<=arrLen ;++i) 
		min = min <= arr[i] ? min : arr[i];

	return min;
}

void main()
{
	int i, j, k;
	int A, B, Awin, Bwin;
	int max, min;

	int testNum, teamNum, playNum;
	float teamRecord[3][1001];

	FILE *inFile = fopen("input.txt", "r");
	fscanf(inFile, "%d", &testNum);

	for(i=0; i<testNum; ++i){

		fscanf(inFile, "%d %d", &teamNum, &playNum);
		
		for(j=0; j<3; ++j){
			for(k=0; k<=teamNum; ++k){
				teamRecord[j][k] = 0;
			}
		}

		for(j=0; j<playNum; ++j) {
			fscanf(inFile, "%d %d %d %d", &A, &B, &Awin, &Bwin);
			teamRecord[WIN][A] += Awin;
			teamRecord[LOSE][A] += Bwin;
			teamRecord[WIN][B] += Bwin;
			teamRecord[LOSE][B] += Awin;
		}

		for(j=1; j<=teamNum; ++j){
			if(teamRecord[WIN][j]==0 && teamRecord[LOSE][j]==0) break;
			teamRecord[Wdata][j] = W(teamRecord[WIN][j], teamRecord[LOSE][j]);
		}

		max = (int)(FindMax(teamRecord[Wdata], teamNum)*1000);
		min = (int)(FindMin(teamRecord[Wdata], teamNum)*1000);
		printf("%d\n", max);
		printf("%d\n", min);
	}
	fclose(inFile);
}

 