

#include <iostream>
#include <fstream>
#include <cstdlib>
#define SIZE 100
using namespace std;

void floodFill(char fig[][SIZE + 1], int x, int y, char oldColor, char newColor, int count, int room[SIZE]) {

	if (fig[x][y] != oldColor)
		return;
	if (fig[x][y] == '.')
	{
		fig[x][y] = newColor;
		room[count]++;
		floodFill(fig, x - 1, y, oldColor, newColor, count, room);
		floodFill(fig, x + 1, y, oldColor, newColor, count, room);
		floodFill(fig, x, y - 1, oldColor, newColor, count, room);
		floodFill(fig, x, y + 1, oldColor, newColor, count, room);
	}
}
int main()
{
	ifstream instream("input.txt");
	int numtestcases, m, n, temp;
	
	instream >> numtestcases;
	for (int i = 0; i < numtestcases; i++){
		instream >> m >> n;
		temp=0;
		char data[SIZE+1][SIZE + 1] = { 0 };
		int roomcount = 0;
		int room[SIZE + 1] = { 0 };
		for (int i = 0; i < n; i++){
			for (int j = 0; j < m; j++){
				instream >> data[i][j];
			}
		}

		for (int i = 0; i < n; i++){
			for (int j = 0; j < m; j++){
				if (data[i][j] == '.')
					roomcount++;
				floodFill(data, i, j, '.', '*',roomcount,room);
			}
		}
		
		cout << roomcount << endl;

		for (int i = 0; i < roomcount-1; i++){
			for (int j = 1; j < roomcount-i; j++)
			{
				if (room[j] < room[j+1]){
					temp = room[j];
					room[j] = room[j+1];
					room[j+1] = temp;
				}
			}
		}

		for (int i = 1; i < roomcount+1; i++)
			cout << room[i] << " ";
		cout<<endl;

	}
	instream.close();
}