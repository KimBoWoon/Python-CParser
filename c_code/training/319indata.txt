
#include <iostream>
#include <fstream>
#include <algorithm>

using namespace std;
int size = 0;

bool cmp(int a, int b) { return a>b; }

void getRoomSize(char room[][100], int i, int j){
    if(room[i][j] != '.')
        return;
    else{
        size++;
        room[i][j] = '+';
        getRoomSize(room, i-1, j);
        getRoomSize(room, i, j+1);
        getRoomSize(room, i+1, j);
        getRoomSize(room, i, j-1);
    }
}

int main(){
    ifstream inStream;
    inStream.open("input.txt");
    int test_case;
    inStream >> test_case;

    for(int t=0; t<test_case; t++){
        int row, column;
        inStream >> column >> row;
        
        char room[100][100];

        for(int i=0; i<row; i++){
            for(int j=0; j<column; j++){
                inStream >> room[i][j];
            }
        }
        
        int numOfRoom = 0;
        int rooms[100];
        for(int i=1; i<row-1; i++){
            for(int j=1; j<column-1; j++){
                if(room[i][j] == '.'){
                    size = 0;
                    getRoomSize(room, i, j);
                    rooms[numOfRoom] = size;
                    numOfRoom++;
                }
            }
        }

        sort(rooms, rooms+numOfRoom, cmp);

        cout << numOfRoom << endl;
        for(int i=0; i<numOfRoom; i++){
            cout << rooms[i] << " ";
        }
        cout << endl;
    }
}
