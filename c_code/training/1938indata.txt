
#include <iostream>
#include <fstream>
#include <vector>
#include <algorithm>
#include <cstdlib>

using namespace std;

int main()
{
	ifstream instream;
	instream.open("input.txt");
	if(!instream)
	{
		cout << "파일을 열 수 없습니다." << endl;
		return 0;
	}
	int testcase;
	instream >> testcase;
	for(int z=0; z<testcase; z++)
	{
		int n, m; 
		instream >> n >> m;
		int PlusArr[1001]={0}; 
		int MinusArr[1001]={0}; 
		for(int i=0; i<m; i++)
		{
			int a,b,p,q;
			instream >> a >> b >> p >> q;
			PlusArr[a] += p; 
			PlusArr[b] += q; 
			MinusArr[a] += q; 
			MinusArr[b] += p; 
			
		}
		
		vector <float> WArr;
		
		for(int i=1; i<=n; i++) 
		{
			float W=0;
			if(PlusArr[i] == 0 || MinusArr[i] ==0)
			{
				W=0;
			}	
			else
			{
				W = (PlusArr[i]*PlusArr[i]) * 1000/ ((PlusArr[i]*PlusArr[i])+(MinusArr[i]*MinusArr[i]));
			}
			WArr.push_back(W);
		}
		sort(WArr.begin(),WArr.end()); 
	
			cout << WArr[n-1]<< endl << WArr[0] << endl;
	}
}
