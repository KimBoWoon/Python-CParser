


#include <stdio.h>

#define MAX 100

void BubbleSort(int *cnt, int num){
	int temp,i,j;

	for(i=0;i<num;i++){
		for(j=0;j<num;j++){
			if(cnt[i]>cnt[j]){
				temp=cnt[i];
				cnt[i]=cnt[j];
				cnt[j]=temp;
			}
		}
	}
}

void makeRoom(FILE *fp,int row,int column,char room[][MAX]){
	int i,j;
	for(i=0;i<column;i++)
			fscanf(fp,"%s",room[i]);	
}

void findRoom(int i,int j,int *cnt,char room[][MAX],int num){
	if(room[i][j]!='.') return; 
	else{	
		room[i][j] = '1';
		cnt[num]++;
		findRoom(i-1,j,cnt,room,num);	
		findRoom(i+1,j,cnt,room,num);	
		findRoom(i,j-1,cnt,room,num);	
		findRoom(i,j+1,cnt,room,num);	
	}
}

void printResult(int *cnt,int num){
	int i;

	printf("%d\n", num);
	for(i=0;i<num;i++)
		printf("%d ", cnt[i]);
	printf("\n");
}

void RoomSize(FILE *fp){
	int row,column;
	int i,j,k=0,num=0;
	int cnt[MAX]={0};
	char room[MAX][MAX];

	fscanf(fp,"%d %d",&row,&column);
	makeRoom(fp,row,column,room);	
	for(i=0;i<column;i++)
		for(j=0;j<row;j++)
			if(room[i][j]=='.')
				findRoom(i,j,cnt,room,num++);	
	BubbleSort(cnt,num);	
	printResult(cnt,num);	
}

int main(){
	int cases,i;

	FILE *infile = fopen("input.txt","r");
	fscanf(infile,"%d",&cases);

	for(i=0;i<cases;i++){
		RoomSize(infile);
	}
	fclose(infile);
	return 0;
}