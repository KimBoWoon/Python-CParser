
#include <iostream>
#include <fstream>
using namespace std;
int rows, cols;
int roomNumber=1;
int roomSize[101];
int size=0;
int size_L=0;
void calculateRoomSize(char **input,int x, int y)	
{

	if(input[y][x]=='.')
	{
		size++;
		input[y][x]=roomNumber;		
		calculateRoomSize(input,x,y+1);
		calculateRoomSize(input,x,y-1);
		calculateRoomSize(input,x+1,y);
		calculateRoomSize(input,x-1,y);
	}
	else
	{
		roomSize[roomNumber]=size;		
		return;
	}
}
int main()
{
   fstream in;
   in.open("input.txt");
   int numcases;
   in>> numcases;
   for(int i =0; i<numcases; i++){
     
    in>>rows>>cols;
	size=0;
    char **input=new char* [cols];
    for(int j=0; j<cols; j++)
    {
       input[j]=new char[rows];
       in>>input[j];
    }
    for(int j=1; j<cols; j++)
    {
       for(int k=1; k<rows; k++)
       {
		   if(input[j][k]=='.'){ calculateRoomSize(input,k,j);size=0;roomNumber++;}
       }
	   
    }
	
	roomNumber--;
	for(int j=1; j<roomNumber; j++)
	{
		for(int k=j+1; k<=roomNumber; k++)
		{
			if(roomSize[j]<roomSize[k])
			{
				int temp;
				temp=roomSize[j];
				roomSize[j]=roomSize[k];
				roomSize[k]=temp;
			}
		}
	}
	cout<<roomNumber<<endl;
	for(int j=1; j<=roomNumber; j++) cout<<roomSize[j]<<" ";
	cout<<endl;
	
	
	
	
	roomNumber=1;
	delete input;
   }

   return 0;
}
