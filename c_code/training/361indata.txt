
#include<iostream>
#include<fstream>
#include <cstring>
#include <algorithm>

#define SIZE 9
using namespace std;
int row, col;
int RoomSizeCnt = 0;
int RoomsizeArr[10000] = { 0 };

int compare(const void * a, const void * b)
{
	return -(*(int*)a - *(int*)b);
}
void sizeOfRoom(char arr[100][100], int x, int y, char oldColor, char newColor) {

	if (arr[x][y] != oldColor) {
		return;
	}

	else
	{
		arr[x][y] = '1';
		RoomSizeCnt++;
		sizeOfRoom(arr, x - 1, y, oldColor, newColor);
		sizeOfRoom(arr, x + 1, y, oldColor, newColor);
		sizeOfRoom(arr, x, y - 1, oldColor, newColor);
		sizeOfRoom(arr, x, y + 1, oldColor, newColor);
	}
}

int main(void)
{
	int testCase, num = 0;
	char str[1001];
	fstream instream("input.txt", ios::in);
	instream >> testCase;
	for (int q = 0; q < testCase; q++)
	{
		int a = 0;
		col = 0; row = 0;
		instream >> col >> row;		
		char arr[100][100];
		for (int i = 0; i < row; i++) {
			for (int j = 0; j < col; j++) {
				instream >> arr[i][j];
			}
		}
		for (int i = 0; i < row; i++) {
			for (int j = 0; j < col; j++) {
				RoomSizeCnt = 0;
				sizeOfRoom(arr, i, j, '.', '+');
				if (RoomSizeCnt != 0) {
					RoomsizeArr[a++] = RoomSizeCnt;
				}
			}
		}
		qsort(RoomsizeArr, a, sizeof(int), compare);
		cout << a << endl;
		for (int i = 0; i < a; i++)
			cout << RoomsizeArr[i] << " ";

		cout << endl;
		RoomsizeArr[10000] = { 0 };
		a = 0;

	}
	return 0;
}
