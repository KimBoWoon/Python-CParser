#include <iostream>
#include <algorithm>
#include <fstream>
#include <cstdlib>
using namespace std;

char arr[100][100]={0};
int m,n;
int cnt;
void check(int i,int j,int size[])
{
	if((i>=0 && i<n) && (j>=0 && j<m))
	{
		if(arr[i][j]!='.') return;
		else
		{
			arr[i][j]=cnt+1;
			size[cnt]++;
			check(i-1,j,size);
			check(i+1,j,size);
			check(i,j-1,size);
			check(i,j+1,size);
		}
	}
}
int main()
{
	ifstream in;
	in.open("input.txt");
	int t;
	in>>t;
	while(t--)
	{
		in>>m>>n;
		cnt=0;
		int size[100]={0};
		for(int i=0;i<n;i++) in>>arr[i];
		for(int i=1;i<n;i++)
		{
			for(int j=1;j<m;j++)
			{
				if(arr[i][j]=='.')
				{
					check(i,j,size);
					cnt++;
				}
			}
		}
		cout<<cnt<<endl;
		sort(size,size+cnt);
		for(int i=cnt-1;i>=0;i--) cout<<size[i]<<" ";
		cout<<"\n";
	}
}