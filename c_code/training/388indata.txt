




#include<iostream>
#include<fstream>
#include<string>
using namespace std;

ifstream inFile("input.txt");
class Room{
private :
	string* room;
	int row,col,c;
	int* count;

public : 
	Room(){
		inFile >> col >> row;
		room = new string[row];
		for (int i = 0; i < row; i++){
			inFile >> room[i];
		}
		count = new int[row*col/2];
		c = 0;
		for (int i = 0; i < row*col/2; i++){
			count[i] = 0;
		}
	}
	void checkRoom(){
		for (int y = 1; y < row; y++){
			for (int x = 1; x < col; x++){
				if (room[y][x] == '.'){
					checkNode(x, y);
					for (int i = 0; i < c; i++){
						if (count[i] < count[c]){
							int temp = count[c];
							for (int j = c; j > i; j--){
								count[j] = count[j - 1];
							}
							count[i] = temp;
							break;
						}
					}
					c++;
				}
			}
		}
		
	}
	void printRoom(){
		cout << c << endl;
		for (int i = 0; i < c; i++){
			cout << count[i] << " ";
		}
		cout << endl;
	}
	void checkNode(int x, int y){
		if (room[y][x] == '+')
			return;
		if (room[y][x] == '.'){
			count[c]++;
			room[y][x] = '+';
		}
		if (x > 1 && room[y][x-1] == '.'){
			checkNode(x - 1, y);
		}
		if (y > 1 && room[y-1][x] == '.'){
			checkNode(x, y - 1);
		}
		if (x < col - 1 && room[y][x + 1] == '.'){
			checkNode(x + 1, y);
		}
		if (y < row - 1 && room[y+1][x] == '.'){
			checkNode(x, y + 1);
		}
	}
};
int main(){
	int cases;
	inFile >> cases;
	while (cases--){
		Room room;
		room.checkRoom();
		room.printRoom();
	}
	return 1;
}