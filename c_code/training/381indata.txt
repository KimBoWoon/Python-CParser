

#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int num=0, l=0;

void floodFill(char **arr, int x, int y, char oldcolor, char newcolor)
{
	if(arr[x][y] != oldcolor)
		return;
	else
	{
		arr[x][y] = newcolor;
		num++;

		floodFill(arr, x-1, y, oldcolor, newcolor);
		floodFill(arr, x+1, y, oldcolor, newcolor);
		floodFill(arr, x, y-1, oldcolor, newcolor);
		floodFill(arr, x, y+1, oldcolor, newcolor);
	}
}
void swap(int *arr1, int *arr2) 
{
	char temp;

	temp = *arr1;
	*arr1 = *arr2;
	*arr2 = temp;
}

void InsertionSort(int *arr, int l) 
{
	int i, j;
    for(i=1; i <l; i++) 
	{
        for(j=0; j<i; j++) 
		{
            if(arr[j] < arr[i]) 
			{
                swap(&arr[j], &arr[i]);
            }
        }
    }
}

void main()
{
	FILE *file;
	int i, j, k;
	int test;
	int col, low;
	char **arr;
	int arr2[1000]={0};

	file = fopen("input.txt", "r"); 
	fscanf(file, "%d", &test); 
	for(i=0; i<test; i++)
	{
		fscanf(file, "%d %d", &col, &low);
		
		arr=(char**)malloc(sizeof(char*)*(low)); 
		for(j=0; j<low; j++)
		{
			*(arr+j)=(char*)malloc(sizeof(char)*(col));
		}

		for(j=0; j<low; j++) 
		{	
			fscanf(file, "%s",arr[j]);	
		}
		
		for(j=0; j<low; j++) 
		{
			for(k=0; k<col; k++)
			{
				floodFill(arr, j, k, '.', '+');
				
				if(num != 0)
				{
					arr2[l] = num;
					l++;
					num=0;
				}
			}
		}

		InsertionSort(arr2, l); 
		
		printf("%d\n", l); 
		for(j=0; j<l; j++) 
		{
			printf("%d ", arr2[j]);
		}
		printf("\n");
		
		l=0;
	}
	fclose(file); 
}