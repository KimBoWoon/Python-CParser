#include <iostream>
#include <fstream>
#include <cstdlib>
#include <math.h>
using namespace std;


class score
{
public:
	int plus;
	int minus;
	score()
	{
		plus = 0;
		minus = 0;
	}
};

int main()
{
	fstream file;
	file.open("input.txt");

	int testCase;
	file >> testCase;
	while (testCase--)
	{
		int n, m;
		file >> n>> m;
		int **Arr = new int*[m];
		int *count = new int[n];
		for (int i = 0; i < n; i++)
			count[i] = 0;
		for (int i = 0; i < m; i++)
			Arr[i] = new int[4];
		for (int i = 0; i < m; i++)
			for (int j = 0; j < 4; j++)
				file >> Arr[i][j];
		score *S=new score[n];
		double *num = new double[n];
		
		for (int i = 0; i < m; i++)
		{
			S[Arr[i][0]-1].plus += Arr[i][2];
			S[Arr[i][0]-1].minus += Arr[i][3];
			S[Arr[i][1]-1].plus += Arr[i][3];
			S[Arr[i][1]-1].minus += Arr[i][2];
			count[Arr[i][0]-1]++;
			count[Arr[i][1]-1]++;
		}
		double max=-100000, min=1000000;
		for (int i = 0; i < n; i++)
		{
			num[i] = pow((double)S[i].plus, 2);
			double a=(pow((double)S[i].plus, 2) + pow((double)S[i].minus, 2));
			num[i] /= a;
			if (max < num[i])
				max = num[i];
			if (min > num[i])
				min = num[i];
		}
		max *= 1000;
		min *= 1000;
		cout << (int)max << endl << (int)min<<endl;
	}
}