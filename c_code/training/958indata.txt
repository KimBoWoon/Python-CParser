#include<iostream>
#include<fstream>
#include<algorithm>
using namespace std;
int w[100][100],h[100][100],DP[101][101][2][201];
int main()
{
	int k;
	
	ifstream fs;
	fs.open("input.txt");
	fs>>k;
	while(k--)
	{
		int m,n,L,g,rotate=201;
		fs>>m>>n>>L>>g;
		for(int i=0;i<m;i++)
			for(int j=0;j<n-1;j++) fs>>w[i][j];
		for(int i=0;i<m-1;i++)
			for(int j=0;j<n;j++) fs>>h[i][j];
		for(int i=0;i<m;i++)
			for(int j=0;j<n;j++)
				for(int k=0;k<2;k++)
					for(int l=0;l<201;l++) DP[i][j][k][l]=g+1;
		DP[0][0][0][0]=DP[0][0][1][0]=0;
		for(int i=0;i<m;i++)
			for(int j=0;j<n;j++)
				for(int l=0;l<m*2;l++)
					for(int k=0;k<2;k++)
					{
						if(DP[i][j][k][l]>g) continue;
						if(i==m-1&&j==n-1) rotate = min(rotate,l);
						if(l<2*m) DP[i][j][!k][l+1]=min(DP[i][j][!k][l+1],DP[i][j][k][l]);
						if(k && j<n) DP[i][j+1][k][l]=min(DP[i][j+1][k][l],DP[i][j][k][l]+w[i][j]);
						else if(!k && i<m) DP[i+1][j][k][l]=min(DP[i+1][j][k][l],DP[i][j][k][l]+h[i][j]);
					}
		if(rotate == 201)cout<<"-1\n";
		else cout<<(n+m-2)*L+rotate<<"\n";
	}
}