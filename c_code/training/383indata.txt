

#include <iostream> 
#include <fstream> 
#include <algorithm> 
#define MAXLEN (110)
using namespace std;



void floodFill(char arr[MAXLEN][MAXLEN], int i, int j, char colour, int& cnt)
{
	if(arr[i][j]=='.')
	{
		arr[i][j] = colour;
		cnt++;
	
	floodFill(arr, i-1, j, colour, cnt);
	floodFill(arr, i, j-1, colour, cnt);
	floodFill(arr, i, j+1, colour, cnt);
	floodFill(arr, i+1, j, colour, cnt);
	}
}




void check(char arr[MAXLEN][MAXLEN], int m, int n)
{
	char colour = 0; 
	int cnt[MAXLEN] = {0}; 
	for(int i=1; i<n; i++)
		for(int j=1; j<m; j++)
			if(arr[i][j]=='.')
				floodFill(arr, i, j, colour++, cnt[colour]); 

	sort(cnt, cnt+int(colour+1)); 
	cout << int(colour) << endl;
	for(int i=colour; i>0; i--) 
		cout << cnt[i] << ' ';
	cout << endl;
}

int main(){
	ifstream f;
	f.open("input.txt", ifstream::in );
	int numcase;
	f >> numcase;
	for(int i=0; i<numcase; i++){
		int m, n;
		f >> m >> n;
		char room[MAXLEN][MAXLEN];
		for(int i=0; i<n; i++)
			f >> room[i];

		check(room, m, n);
	}
	return 0;
}