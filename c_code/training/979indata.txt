

#include <stdio.h>
#include <stdlib.h>

int minAmountOfFeul[100][100][2][201];

void main(void)
{
	FILE *inFile;
	int i, j, k, l, m;
	int numCases;
	int horizontalLines, verticalLines;
	int drivingTime, amountOfFeul;
	int** horizontalStreets = NULL;
	int** verticalStreets = NULL;
	int rotation;

	inFile = fopen("input.txt", "r"); 

	if (inFile == NULL) exit(1);
	fscanf(inFile, "%d", &numCases); 

	for (i = 0; i<numCases; i++)
	{
		fscanf(inFile, "%d %d %d %d", &horizontalLines, &verticalLines, &drivingTime, &amountOfFeul); 
																									  
		
		horizontalStreets = (int**)malloc(sizeof(int*)*horizontalLines);
		verticalStreets = (int**)malloc(sizeof(int*)*(horizontalLines - 1));
		for (j = 0; j < horizontalLines; j++)
		{
			horizontalStreets[j] = (int*)malloc(sizeof(int)*(verticalLines - 1));
			for (k = 0; k < verticalLines - 1; k++)
				fscanf(inFile, "%d", &horizontalStreets[j][k]); 
		}
		for (j = 0; j < horizontalLines - 1; j++)
		{
			verticalStreets[j] = (int*)malloc(sizeof(int)*(verticalLines));
			for (k = 0; k < verticalLines; k++)
				fscanf(inFile, "%d", &verticalStreets[j][k]);	
		}
		for (j = 0; j < horizontalLines; j++)
			for (k = 0; k < verticalLines; k++)
				for (l = 0; l < 2; l++)
					for (m = 0; m < 201; m++)
						minAmountOfFeul[j][k][l][m] = amountOfFeul + 1;
		minAmountOfFeul[0][0][0][0] = minAmountOfFeul[0][0][1][0] = 0;
		rotation = 200;			

		for (j = 0; j < horizontalLines; j++)
			for (k = 0; k < verticalLines; k++)
				for (l = 0; l < 201; l++)
					for (m = 0; m < 2; m++)
						if (minAmountOfFeul[j][k][m][l] <= amountOfFeul)
						{
							if (j == horizontalLines - 1 && k == verticalLines - 1)
								if (rotation>l)
									rotation = l;
							if (l < 200 && minAmountOfFeul[j][k][!m][l + 1]>minAmountOfFeul[j][k][m][l])
								minAmountOfFeul[j][k][!m][l + 1] = minAmountOfFeul[j][k][m][l];
							if (m)
							{
								if (k<verticalLines - 1 && minAmountOfFeul[j][k + 1][m][l]>minAmountOfFeul[j][k][m][l] + horizontalStreets[j][k])
									minAmountOfFeul[j][k + 1][m][l] = minAmountOfFeul[j][k][m][l] + horizontalStreets[j][k];
							}
							else
							{

								if (j<horizontalLines - 1 && minAmountOfFeul[j+1][k][m][l]>minAmountOfFeul[j][k][m][l] + verticalStreets[j][k])
									minAmountOfFeul[j+1][k][m][l] = minAmountOfFeul[j][k][m][l] + verticalStreets[j][k];
							}
						}
		if (rotation < 200)
			printf("%d\n", (horizontalLines + verticalLines - 2)*drivingTime + rotation);
		else
			printf("-1\n");
	}

	
	for (i = 0; i < horizontalLines; i++)
		free(horizontalStreets[i]);
	for (i = 0; i < horizontalLines - 1; i++)
		free(verticalStreets[i]);
	free(horizontalStreets);
	free(verticalStreets);

	fclose(inFile); 
}