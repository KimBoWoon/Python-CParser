
#include <iostream>
#include <fstream>
#include <string>

int MAX_X, MAX_Y;
int RoomSize[100 * 100];
int RoomNumber;
std::string map[100][100];


void Seach(int x, int y) {
	
	if (map[x][y] == "+")  return;

	RoomSize[RoomNumber]++;
	map[x][y] = "+";
	
	if (x + 1 < MAX_X - 1) Seach(x + 1, y);
	if (y + 1 < MAX_Y - 1) Seach(x, y + 1);
	if (x - 1 > 0) Seach(x - 1, y);
	if (y - 1 > 0) Seach(x, y - 1);
}

int main() {

	std::ifstream fin;

	fin.open("input.txt");
	int numcase, num1, num2;
	std::string str;
	if (fin.is_open() == false)  return -1;
	
	fin >> numcase;
	for (int i = 0; i < numcase; i++) {
		
		fin >> num1 >> num2;
		for (int j = 0; j < RoomNumber; j++) RoomSize[j] = 0;
		RoomNumber = 0;
		MAX_X = num1;
		MAX_Y = num2;

		for (int k = 0; k < num2; k++) {
			fin >> str;
			for (int j = 0; j < num1; j++) {
				map[j][k] = str.at(j);
			}
		}

		for (int k = 1; k < num2 - 1; k++) {
			for (int j = 1; j < num1 - 1; j++) {
				if (map[j][k] == ".") {
					Seach(j, k);
					RoomNumber++;
				}
			}
		}
		
		int change;		
		for (int j = 1; j < RoomNumber; j++) {
			for (int k = 0; k < RoomNumber - j; k++) {
				if (RoomSize[k] < RoomSize[k + 1]) {
					change = RoomSize[k + 1];
					RoomSize[k + 1] = RoomSize[k];
					RoomSize[k] = change;
				}
			}
		}

		std::cout << RoomNumber << std::endl;
		for (int j = 0; j < RoomNumber; j++) std::cout << RoomSize[j] << " ";
		std::cout << std::endl;
	}
	fin.close();
}