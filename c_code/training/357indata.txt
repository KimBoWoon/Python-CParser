

#pragma warning(disable : 4996) 

#include <stdio.h>
#include <stdlib.h>

#define SIZE 100

int roomCountArray[100];
int roomCount;

void floodFill(char roomMatrix[][SIZE + 1], int x, int y, char roomNumber); 
void insert(int data[], int size, int value);	
void insertionSort(int data[], int size);		

void main(void)
{
	FILE *inFile;
	int i, j, k;
	int numCases;
	int width, height;
	char roomMatrix[SIZE][SIZE + 1];

	inFile = fopen("input.txt", "r"); 

	if (inFile == NULL) exit(1);
	fscanf(inFile, "%d", &numCases); 

	for (i = 0; i<numCases; i++)
	{
		fscanf(inFile, "%d %d", &width, &height); 

		for (j = 0; j < height; j++)
			fscanf(inFile, "%s", &roomMatrix[j]);	

		for (j = 0; j < 100; j++)
			roomCountArray[j] = 0;					
		roomCount = 0;								

		for (j = 0; j < height; j++)
			for (k = 0; k < width; k++)
			{
				if (roomMatrix[j][k] == '.')
				{
					floodFill(roomMatrix, j, k, '1');	
					roomCount++;						
				}
			}

		insertionSort(roomCountArray, roomCount);		

		printf("%d\n", roomCount);
		for (j = 0; j < 100; j++)
			if (roomCountArray[j]) printf("%d ", roomCountArray[j]);
		printf("\n");
	}

	fclose(inFile); 
}

void floodFill(char roomMatrix[][SIZE + 1], int x, int y, char roomNumber)
{
	if (roomMatrix[x][y] != '.')
		return;
	else
	{
		roomMatrix[x][y] = roomNumber;
		roomCountArray[roomCount]++;
		floodFill(roomMatrix, x - 1, y, roomNumber);
		floodFill(roomMatrix, x + 1, y, roomNumber);
		floodFill(roomMatrix, x, y - 1, roomNumber);
		floodFill(roomMatrix, x, y + 1, roomNumber);
	}
}

void insert(int data[], int size, int value)
{
	if (size == 0) data[size] = value;
	else
	{
		if (data[size - 1] > value)
			data[size] = value;
		else
		{
			data[size] = data[size - 1];
			insert(data, size - 1, value);
		}
	}
}

void insertionSort(int data[], int size)
{
	if (size == 0) return;
	else
	{
		insertionSort(data, size - 1);
		insert(data, size - 1, data[size - 1]);
	}
}