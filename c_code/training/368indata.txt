

#include<iostream>
#include<fstream>

using namespace std;

static int sum = 0;

void v(char** room, int j, int k);  
void sort(int* arr, int M);	

int main(void)
{
	ifstream inStream;
	inStream.open("input.txt");

	int numTestCases;

	inStream >> numTestCases;

	for (int i = 0; i < numTestCases; i++) {

		int X, Y;
		int roomNumber[1000];
		int roomN = 0;
		inStream >> X >> Y;

		char **room = new char*[Y];
		for (int j = 0; j < Y; j++){
			room[j] = new char[X];
			for (int k = 0; k < X; k++)
				inStream >> room[j][k];
		}
		
		for (int j = 1; j < Y; j++){
			for (int k = 0; k < X; k++){

				if (room[j][k] == '.'){
					sum = 0;
					v(room, j, k);
					roomNumber[roomN++]=sum;
				}
			}
		}

		sort(roomNumber, roomN);

		cout << roomN << endl;

		for (int j = 0; j < roomN; j++)
			cout <<roomNumber[j]<<" ";
		cout << endl;


		for(int j = 0; j < Y; j++)
			delete room[j];
		delete room;

	}
}


void v(char** room,int j, int k){

	sum += 1;
	room[j][k] = '+';

	if (room[j + 1][k] == '.')
		v(room, j + 1, k);

	if (room[j][k + 1] == '.')
		v(room, j, k + 1);

	if (room[j - 1 ][k] == '.')
		v(room, j - 1, k);

	if (room[j][k - 1] == '.')
		v(room, j, k - 1);
}

void sort(int* arr, int M){
	int temp;
	for (int i = 0; i < M ; i++){
		for (int j = i+1; j < M; j++){
			if (arr[i] < arr[j]){
				temp = arr[i];
				arr[i] = arr[j];
				arr[j] = temp;
			}
		}
	}
}