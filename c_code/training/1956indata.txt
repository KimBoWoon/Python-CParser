#include <iostream>
#include <fstream>
#include <cstdlib>

using namespace std;

void cal(fstream &infile);
void cal2(double teams[], double teamf[],int t, int tm);

int main()
{
	int nocases;

	fstream infile;

	infile.open("input.txt");

	if (infile.fail())
	{
		cerr << "파일열기 오류" << endl;
		exit(1);
	}

	infile >> nocases;

	for (int i = 0; i < nocases; i++)
	{
		cal(infile);
	}
}

void cal(fstream &infile)
{
	double teams[1000];
	double teamf[1000];
	int score[1000][4];
	double calnum[1000];
	double calnum2[1000];
	int t;
	int tm;
	int i, j;

	infile >> t;
	infile >> tm;

	for (i = 0; i < tm; i++)
	{
		for (j = 0; j < 4; j++)
		{
			infile >> score[i][j];
		}
	}

	for (i = 0; i < 1000; i++)
	{
		teams[i] = 0;
		teamf[i] = 0;
	}

	for (i = 0; i < tm; i++)
	{
		teams[score[i][0]] += score[i][2];
		teamf[score[i][0]] += score[i][3];

		teams[score[i][1]] += score[i][3];
		teamf[score[i][1]] += score[i][2];
	}

	cal2(teams, teamf, t, tm);
}

void cal2(double teams[], double teamf[],int t, int tm)
{
	double calnum[1000];
	double calnum2[1000];
	long max;
	long min;

	for (int i = 1; i <= t; i++)
	{
		calnum2[i] = ((teams[i] * teams[i]) / ((teams[i] * teams[i]) + (teamf[i] * teamf[i]))) * 1000;
	}

	max = calnum2[1];
	min = calnum2[1];

	for (int i = 2; i <= t; i++)
	{
		if (max < calnum2[i])
		{
			max = calnum2[i];
		}

		if (min > calnum2[i])
		{
			min = calnum2[i];
		}
	}

	cout << max << endl;
	cout << min << endl;
}