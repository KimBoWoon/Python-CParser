
#include<fstream>
#include<iostream>
#include<cstdio>
#include<vector>
#include<algorithm>
using namespace std;
int main()
{
	ifstream fs;
	fs.open("input.txt");
    int n;
    fs >> n;
    while (n--)
    {
        int k, t;
        long long v[1001][2] = { 0 };
        fs >> k >> t;
        vector<long long> d;
        d.clear();
        for (int i = 0; i < t; i++)
        {
            int a, b, c, d;
            fs >> a >> b >> c >> d;
            v[a][0] += c, v[a][1] += d, v[b][0] += d, v[b][1] += c;
        }
        for (int i = 1; i <= k; i++)
        {
            long long l;
            if (v[i][0] * v[i][0] + v[i][1] * v[i][1] == 0)l = 0;
            else l = ((v[i][0] * v[i][0] * 1000) / (v[i][0] * v[i][0] + v[i][1] * v[i][1]));
            d.push_back(l);
        }
        sort(d.begin(), d.end());
        cout << d[d.size() - 1] << "\n" << d[0] << "\n";
    }
}