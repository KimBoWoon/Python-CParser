

#include <stdio.h>
#include <stdlib.h>
#include <string.h>

static int no_rooms = 0;
static char room[100][100];
static int roomsize[100];
static int length;

void roomCal(int w, int h, int no_room);
void printCal(int roomsize[]);

int main(void) {
	FILE *input;
	int no_cases;
	int i, j, k, l;
	int w, h;

	input = fopen("input.txt", "r");
	if (input == NULL)
		exit(1);

	fscanf(input, "%d", &no_cases);

	for (i = 0; i < no_cases; i++) {
		no_rooms = 0;
		length = 1;
		fscanf(input, "%d%d", &w, &h);
		for (j = 0; j < h; j++) {
			fscanf(input, "%s", &room[j]);
		}

		for (k = 1; k < h - 1; k++) {
			for (l = 1; l < w - 1; l++) {
				if (room[k][l] == '.') {
					roomCal(k, l, no_rooms);
					no_rooms++;
					length++;
				}
			}
		}

		printCal(roomsize);
	}

	fclose(input);
	return 0;

}

void roomCal(int w, int h, int no_room) {

	if (room[w][h] != '+' && room[w][h] == '.') {
		room[w][h] = '5';
		roomsize[no_room]++;
		roomCal(w, h, no_room);
	}
	if (room[w - 1][h] != '+' && room[w - 1][h] == '.') {
		room[w - 1][h] = '5';
		roomsize[no_room]++;
		roomCal(w - 1, h, no_room);
	}
	if (room[w + 1][h] != '+' && room[w + 1][h] == '.') {
		room[w + 1][h] = '5';
		roomsize[no_room]++;
		roomCal(w + 1, h, no_room);
	}
	if (room[w][h - 1] != '+' && room[w][h - 1] == '.') {
		room[w][h - 1] = '5';
		roomsize[no_room]++;
		roomCal(w, h - 1, no_room);
	}
	if (room[w][h + 1] != '+' && room[w][h + 1] == '.') {
		room[w][h + 1] = '5';
		roomsize[no_room]++;
		roomCal(w, h + 1, no_room);
	}
}

void printCal(int roomsize[]) {
	int i, j;
	int temp;
	for (i = 0; i < length - 1; i++) {
		for (j = 0; j < length - 1; j++) {
			if (roomsize[j] < roomsize[j + 1]) {
				temp = roomsize[j];
				roomsize[j] = roomsize[j + 1];
				roomsize[j + 1] = temp;
			}
		}
	}

	printf("%d\n", length - 1);
	for (i = 0; i < length - 1; i++) {
		printf("%d ", roomsize[i]);
	}

	for (i = 0; i < length - 1; i++) {
		roomsize[i] = 0;
	}

	printf("\n");

}