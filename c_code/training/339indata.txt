

#include<iostream>
#include<fstream>
#include<string>
using namespace std;

void checkRoom(char room[][100], int x, int y, char empty, char roomNum);
int cntRoomSize(char room[][100], int height, int width, char num);
int main()
{
	int numOfCase = 0;	
	char room[100][100] = { 0 };

	int width, height;


	ifstream input("input.txt");
	if (input.fail()){
		cout << "파일을 여는 데 실패했습니다." << endl;
	}
	input >> numOfCase;

	for (int i = 0; i < numOfCase; i++){
		input >> width;		
		input >> height;	
		char num = '1';
		int roomSize[1000] = { 0 };

		for (int h = 0; h < height; h++){	
			for (int w = 0; w < width; w++){
				input >> room[w][h];
			}
		}
		
		for (int h = 0; h < height; h++){	
			for (int w = 0; w < width; w++){
				if (room[w][h] == '.'){		
					checkRoom(room, w, h, '.', num);	
					num++;	
				}
			}
		}
		
		for (char k = '1'; k < num; k++){
			roomSize[k-49] = cntRoomSize(room, height, width, k); 
		}
		for (char k = '1'; k < num; k++){	
			for (char t = '1'; t < k; t++){
				if (roomSize[t - 49] < roomSize[k - 49]){
					int temp = roomSize[t - 49];
					roomSize[t - 49] = roomSize[k - 49];
					roomSize[k - 49] = temp;
				}
			}
		}
		int n = num - 49;
		cout << n << endl;	
		for (char k = '1'; k < num; k++){
			cout << roomSize[k-49] <<" ";
		}
		cout << endl;

	}
	input.close();
	return 0;
}

void checkRoom(char room[][100], int x, int y, char empty, char roomNum){
	if (room[x][y] != empty)
		return;
	else
	{
		room[x][y] = roomNum;	
		checkRoom(room, x - 1, y, empty, roomNum);	
		checkRoom(room, x + 1, y, empty, roomNum);	
		checkRoom(room, x, y - 1, empty, roomNum);	
		checkRoom(room, x, y + 1, empty, roomNum);	
	}
}

int cntRoomSize(char room[][100], int height, int width, char num){
	int size = 0;
	for (int h = 0; h < height; h++){	
		for (int w = 0; w < width; w++){
			if (room[w][h] == num){
				size++;
			}
		}
	}
	return size;
}
