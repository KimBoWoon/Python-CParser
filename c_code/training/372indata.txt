#include <iostream>
#include <fstream>
using namespace std;

void findroomsize(char room[][101], char space, char wall, int a, int b, int roomsize[],int roomcount)
{
	if(room[a][b] != space)
		return ;
	else
	{
		room[a][b] = wall; 
		roomsize[roomcount]++;
		findroomsize(room,'.','+',a,b+1,roomsize,roomcount); 
		findroomsize(room,'.','+',a,b-1,roomsize,roomcount); 
		findroomsize(room,'.','+',a+1,b,roomsize,roomcount); 
		findroomsize(room,'.','+',a-1,b,roomsize,roomcount); 

	}
}
void sort(int roomsize[10000], int roomcount)
{
	for(int i=0; i<roomcount; i++)
	{

	}
}
int main()
{
	ifstream instream;
	instream.open("input.txt");
	if(!instream)
	{
		cout << "파일을 열 수 없습니다." << endl;
		return 0;
	}
	int testcase;
	instream >> testcase;
	for(int z=0; z<testcase; z++)
	{
		int garo, sero;
		char room[101][101]; 
		int roomsize[10000] ={0};
		int roomcount =0;
		instream >> garo >> sero;

		for(int i=0; i<sero; i++) 
			for(int j=0; j<garo; j++) 
				instream >> room[i][j];

		for(int a=0; a<sero; a++){
			for(int b=0; b<garo; b++)
			{
				if(room[a][b] =='.')
				{
					findroomsize(room,'.','+',a,b,roomsize,roomcount);
					roomcount++;
				}
			}

		}
		cout << roomcount << endl; 

		for(int i=0; i<roomcount; i++) 
		{
			for(int j=0; j<roomcount; j++)
			{
				int temp;
				if(roomsize[j] < roomsize[j+1])
				{
					temp = roomsize[j];
					roomsize[j] = roomsize[j+1];
					roomsize[j+1] = temp;
				}
			}

		}
		for(int i=0; i<roomcount; i++)
		{
			cout << roomsize[i] << " ";
		}
		cout << endl;



	}
}