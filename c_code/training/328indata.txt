


#include <stdio.h>
#include <stdlib.h>
#pragma warning(disable : 4996)
void countSize(char room[103][104], int x, int y, char space, char number);
int roomArr[4500] = { 0 };
int count = 0;
void main(void)
{
	FILE* inFile;
	int testCase = 0, width = 0, height = 0, temp = 0;
	int i = 0, j = 0, k = 0, l = 0, number = 0;
	char room[103][104] = { 0 };
	inFile = fopen("input.txt", "r"); 
	if (inFile == NULL) exit(1);
	fscanf(inFile, "%d", &testCase); 
	for (i = 0; i < testCase; i++)
	{
		fscanf(inFile, "%d %d", &width, &height); 
		for (j = 1; j <= height; j++)
		{
				fscanf(inFile, "%s", &room[j]);
		}
		for (j = 1; j <= height; j++)
		{
			for (k = 0; k <= width; k++)
			{
				countSize(&room, j, k, '.', '1');
				roomArr[l++] = count;
				count = 0;
			}
		}
		for (j = 0; j < 4500; j++)
		{
			if (roomArr[j] != 0)
				number++;
		}
		printf("%d\n", number);
		for (j = 0; j < 4500; j++)
		{
			for (k = 0; k < 4500; k++)
			{
				if (roomArr[k] < roomArr[k + 1])
				{
					temp = roomArr[k];
					roomArr[k] = roomArr[k+1];
					roomArr[k + 1] = temp;
				}
			}
		}
		for (j = 0; j < 4500; j++)
		{
			if (roomArr[j] != 0)
				printf("%d ", roomArr[j]);
		}
		for (j = 0; j < 4500; j++)
		{
			roomArr[j] = 0;
		}
		printf("\n");
		number = 0;
		count = 0;
	}
	fclose(inFile);
}
void countSize(char room[103][104], int x, int y, char space, char number)
{
	if (room[x][y] != '.')
	{
		return;
	}
	else
	{
		room[x][y] = number;
		count++;
		countSize(room, x - 1, y, space, number);
		countSize(room, x + 1, y, space, number);
		countSize(room, x, y - 1, space, number);
		countSize(room, x, y + 1, space, number);
	}
}