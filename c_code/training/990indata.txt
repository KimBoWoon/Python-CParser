

#include <stdio.h>

int T, M, N, L, G;
int low[101][101], col[101][101], path[101][101][2][201];

int main()
{
        FILE* inFile = fopen("input.txt", "r");
        int i, j, k, l;

        for (fscanf(inFile, "%d", &T);T--;){
                fscanf(inFile, "%d %d %d %d", &N, &M, &L, &G);
                for (i=1;i<=N;i++) for (j=1;j<M;j++) fscanf(inFile, "%d", low[i]+j);
                for (i=1;i<N;i++) for (j=1;j<=M;j++) fscanf(inFile, "%d", col[i]+j);
                for (i=1;i<=N;i++) for (j=1;j<=M;j++) for (k=0;k<2;k++) for (l=0;l<201;l++) path[i][j][k][l] = G+1;
                path[1][1][0][0] = path[1][1][1][0] = 0;

                int ans = 200;
                for (i=1;i<=N;i++) for (j=1;j<=M;j++) for (l=0;l<201;l++) for (k=0;k<2;k++) if (path[i][j][k][l] <= G){
                        if (i == N && j == M){
                                if (ans > l) ans = l;
                        }
                        if (l < 200 && path[i][j][!k][l+1] > path[i][j][k][l])
                                path[i][j][!k][l+1] = path[i][j][k][l];
                        if (k){
                                if (j < M && path[i][j+1][k][l] > path[i][j][k][l]+low[i][j])
                                path[i][j+1][k][l] = path[i][j][k][l]+low[i][j];
                        }
                        else{
                                if (i < N && path[i+1][j][k][l] > path[i][j][k][l]+col[i][j])
                                        path[i+1][j][k][l] = path[i][j][k][l]+col[i][j];
                        }
                }
                if (ans < 200) printf("%d\n", (N+M-2)*L+ans);
                else printf("-1\n");
        }
}
