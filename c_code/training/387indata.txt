

#include <iostream>
#include <fstream>

using namespace std;
int roomSize[101];
char room[101][101];
int roomNum=1;

void floodFill(int x, int y);
void swap(int *str1, int *str2);

int main()
{
	ifstream infile;
	int testCase;
	int row, col;
	
	infile.open("input.txt");

	infile >> testCase;
	for (int i = 0; i < testCase; i++)
	{
		infile >> col >> row;
		for (int j = 0; j < row; j++)
			for (int k = 0; k < col; k++)
				infile >> room[j][k];

		for (int j = 1; j < row; j++)
		{
			for (int k = 1; k < col; k++)
			{
				if (room[j][k] == '.')
				{
					floodFill(j, k);
					roomNum++;
				}
			}
		}
		roomNum--;
		for (int j = 1; j < roomNum; j++) 
		{
			for (int k = j + 1; k <= roomNum; k++)
			{
				if (roomSize[j] < roomSize[k])
					swap(&roomSize[j], &roomSize[k]);
			}
		}

		cout << roomNum << endl;
		for (int j = 1; j <= roomNum; j++)
			cout << roomSize[j] << " ";
		cout << endl;

		for (int j = 1; j <= roomNum; j++) 
			roomSize[j] = 0;
		roomNum = 1;

	}	
	infile.close();

	return 0;
}

void floodFill(int x, int y)

{
	if (room[x][y] != '.' )
	{
		return;
	}
	else 
	{
		room[x][y] = roomNum;
		roomSize[roomNum]++;
		floodFill(x - 1, y);
		floodFill(x + 1, y);
		floodFill(x, y - 1);
		floodFill(x, y + 1);	
	}
}
void swap(int *str1, int *str2)
{
	int tmp;

	tmp = *str1;
	*str1 = *str2;
	*str2 = tmp;
}

