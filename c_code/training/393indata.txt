#include <iostream>
#include <fstream>
#include <cstring>
#include <cstdlib>
using namespace std;

int number = 0;
int size[100] = { 0 };

void floodFill(char fig[][101], int x, int y, char room, char wall) {
	if (fig[x][y] != room ) {
		return;
	}
	else {

		fig[x][y] = wall;
		size[number]++;

		floodFill(fig, x - 1, y, room, wall);
		floodFill(fig, x + 1, y, room, wall);
		floodFill(fig, x, y - 1, room, wall);
		floodFill(fig, x, y + 1, room, wall);
	}
}

int compare(const int *x, const int *y)
{
	if (*x > *y)
		return  -1;
	else
		return 1;
}

int main() {
	ifstream fin;
	fin.open("input.txt");
	if (!fin) {
		cout << "ERROR!";
		return 0;
	}

	int testCase = 0;

	int m = 0; 
	int n = 0; 
	

	fin >> testCase;

	char fig[100][101] = { 0 };

	while (testCase--) {
		int i, j;
		number = 0;
		memset(size, 0, sizeof(size));
		memset(fig, 0, sizeof(fig)); 

		fin >> m >> n; 

		for (i = 0; i < n; i++) { 
			fin >> fig[i];
		}	

		for (i = 0; i < n; i++) {
			for (j = 0; j < m; j++) {
				if (fig[i][j] == '.'){
					floodFill(fig, i, j, '.', '+');
					++number;
				}
			}
		}
		qsort(size, number, sizeof(int), (int(*)(const void *, const void *))compare);
		cout << number << endl;

		for (int i = 0; i < number; i++) {
			cout << size[i] << " ";
		}
		cout << endl;
				
	}

	fin.close();

}

