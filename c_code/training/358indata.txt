


#include <iostream>
#include <fstream>
using namespace std;
int cnt = 0;
void floodFill(char fig[][100], int x, int y, char oldColor, char newColor){
	if (fig[x][y] != oldColor){
		return;
	}
	else{
		fig[x][y] = newColor;
		cnt++;
		floodFill(fig, x - 1, y, oldColor, newColor);
		floodFill(fig, x + 1, y, oldColor, newColor);
		floodFill(fig, x, y - 1, oldColor, newColor);
		floodFill(fig, x, y + 1, oldColor, newColor);
	}
}

void sort(int *arr,int cnt){
	int temp;
	for (int i = 0; i < cnt; i++){
		for (int j = 0; j < cnt - 1; j++){
			if (arr[j]<arr[j + 1]){
				temp = arr[j];
				arr[j] = arr[j + 1];
				arr[j + 1] = temp;
			}
		}
	}
}
int main(void){
	ifstream in;
	in.open("input.txt");
	int testcases;
	in >> testcases;
	char fig[100][100]; 
	int cntArr[100];
	int Arrcnt = 0;
	for (int i = 0; i < testcases; i++){
		int row, col;
		in >> row >> col;
		for (int j = 0; j< col; j++){
			for (int k = 0; k < row; k++)
				in>>fig[j][k];
		}

		for (int j = 0; j< col; j++){
			for (int k = 0; k < row; k++){
				if (fig[j][k] == '.'){
					floodFill(fig, j, k, '.', '+');
					cntArr[Arrcnt] = cnt;
					cnt = 0;
					Arrcnt++;
				}
			}
		}
		sort(cntArr, Arrcnt);

		cout << Arrcnt << endl;
		for (int k = 0; k < Arrcnt; k++){
			cout << cntArr[k] << ' ';
		}
		cout << endl;
		Arrcnt = 0;
	}
}