

#include <iostream>
#include <fstream>
#include <cstdlib>
using namespace std;

int num=0;						
int area[100]={0};			

void roomNum(char room[][101], int x, int y, int num2, int num1){		
	
	if(room[x][y]=='.'){
		area[num]++;
		room[x][y]=',';
	}	
	if(room[x][y+1]=='.'){
		roomNum(room, x, y+1, num2, num1);
	}
	if(room[x][y-1]=='.'){
		roomNum(room, x, y-1, num2, num1);
	}
	if(room[x+1][y]=='.'){
			roomNum(room, x+1, y, num2, num1);
	}
	if(room[x-1][y]=='.'){
		roomNum(room, x-1, y, num2, num1);
	}
	
}

int main(){
	ifstream infile;
	int i, testCase;
	infile.open("input.txt");
	infile>>testCase;

	for(i=0; i<testCase; i++){
		char room[100][101]={0};
		char s;
		int num1, num2;
		int j, k,a,temp;
		infile>>num1>>num2;
		
		for(j=0; j<num2; j++){					
			for(k=0; k<num1; k++){
				infile>>s;
				room[j][k]=s;
			}
		}
		for(j=1; j<num2; j++){					
			for(k=1; k<num1; k++){
				if(room[j][k]=='.'){
					num++;
					roomNum(room, j, k, num2, num1);		
				}
		
			}
		}

		for(j=1; j<=num-1; j++){				
			for(k=j+1; k<=num; k++){
				if(area[j]<area[k]){
					temp=area[j];
					area[j]=area[k];
					area[k]=temp;
				}
			}
		}
		
		cout<<num<<endl;					
		for(a=1; a<=num; a++){			
			cout<<area[a]<<" ";
		}
		cout<<endl;
		num=0;								
		for(a=0; a<100; a++)
			area[a]=0;

	}

	return 0;

}