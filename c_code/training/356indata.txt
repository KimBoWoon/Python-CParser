
#include <iostream>
#include <fstream>
#include <algorithm>


using namespace std;

int sum = 0;

void floodFill(char **fig, int a, int b)
{
	if(fig[a][b] == '.')			
	{
		fig[a][b] ='+';
		sum++;
		floodFill(fig,a+1,b);
		floodFill(fig,a,b+1);
		floodFill(fig,a-1,b);
		floodFill(fig,a,b-1);
	}
}

bool cmp(int a, int b) { return a>b; }

int main(){

	ifstream inStream;
	inStream.open("input.txt");		

	int num_case;	

	inStream >> num_case;

	for(int i=0; i< num_case ; i++){
		int x, y;

		inStream >> x >> y;
	
		char **fig = new char*[y];

		for(int i= 0; i< y; i++)
		{
			fig[i] = new char[x];
		}

		for(int i = 0 ; i< y; i++){
			for(int j=0 ; j< x; j++){
				inStream >> fig[i][j];
			}
		}
		int count = 0;
		int arr[1000];

		for(int i = 1; i< y-1; i++)
		{
			for(int j = 1;  j<x-1; j++)
			{
				floodFill(fig,i,j);

				if(fig[i+1][j] =='+' && fig[i-1][j] =='+' && fig[i][j+1] =='+' && fig[i][j-1] =='+')
				{
					if(sum != 0){
					
						arr[count]=sum;
						count++;

					}
					sum = 0;
				}

			}
		}

		sort(arr,arr+count,cmp);

		cout<<count<<endl;
		for(int i= 0; i< count; i++)
			cout<<arr[i]<<" ";
		cout<<endl;
		count = 0;


		for(int i = 0 ; i<y; i++)
			delete []fig[i];

		sum = 0;
	}

}