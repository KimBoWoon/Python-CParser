


#include <stdio.h>

#define MAXSIZE 1001
#define MAX(A,B) A>B?A:B
#define MIN(A,B) A>B?B:A

void Pythagorean(int n,double *S,double *A){
	int W,i,min=1000,max=0;
	for(i=1;i<=n;i++){
		if(S[i]==0 && A[i]==0) 
			W=0;
		else
			W=(S[i]*S[i]/(S[i]*S[i]+A[i]*A[i]))*1000; 
		max=MAX(W,max); 
		min=MIN(W,min); 
	}
	printf("%d\n", max);
	printf("%d\n", min);
}

int main(){
	int cases,n,m,i,j,q,w,e,r;
	double S[MAXSIZE],A[MAXSIZE];
	FILE *fp=fopen("input.txt","r");
	fscanf(fp,"%d",&cases);
	while(cases--){
		fscanf(fp,"%d %d",&n,&m);
		for(i=1;i<=n;i++)
			S[i]=A[i]=0;
		for(i=0;i<m;i++){
			fscanf(fp,"%d %d %d %d",&q,&w,&e,&r);
			S[q]+=e;
			A[q]+=r;
			S[w]+=r;
			A[w]+=e;
		}
		Pythagorean(n,S,A);
	}
	fclose(fp);
	return 0;
}