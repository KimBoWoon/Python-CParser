

#include<iostream>
#include<fstream>
#include<cstdlib>
#include<string>
using namespace std;
char** makeRoom(int m, int n);
void checkRoom(char** roomMatrix, int x, int y, int n, int m);
void sortArray(int* roomCount);
int roomCount[100];
int roomCounter = 0;

int main()
{
	ifstream inStream;
	inStream.open("input.txt");
	if (inStream.fail()) exit(1);
	int numTest;
	int m,n;
	inStream >> numTest;
	char** roomMatrix;

	char ch;
	for (int i = 0; i < numTest; i++){
		inStream >> m >> n;
		roomMatrix = makeRoom(m, n);
		roomCounter = 0;
		for (int k = 0; k < n; k++)
		{
			for (int j = 0; j < m; j++)
			{
				inStream >> ch;
				roomMatrix[k][j] = ch;
			}
		}
		
		for (int k = 1; k < n; k++)
		{
			for (int j = 0; j < m; j++)
			{
				if (roomMatrix[k][j] == '.'){
					checkRoom(roomMatrix, k, j, n, m);
					roomCounter++;
				}
			}
		}
		cout << roomCounter<<endl;
		sortArray(roomCount);

		for (int k = 0; k < n; k++){
			delete[] roomMatrix[k];
		}
		delete[] roomMatrix;
	}

}
void checkRoom(char** roomMatrix, int x, int y ,int n, int m)
{ 
	if (x < 0 || y < 0 || x >= n || y >= m) return;
	if (roomMatrix[x][y] == '.'){
		roomMatrix[x][y] = '-'; 
		roomCount[roomCounter]++; 
	}
	else if (roomMatrix[x][y] == '+') return;
	else return;
	checkRoom(roomMatrix, x, y + 1, n, m); 
	checkRoom(roomMatrix, x+1, y , n, m); 
	checkRoom(roomMatrix, x, y - 1, n, m); 
	checkRoom(roomMatrix, x-1, y, n, m); 
}

char** makeRoom(int m, int n)
{
	char** room;
	room = new char*[n];
	for (int k = 0; k < n; k++)
	{
		room[k] = new char[m];
	}
	return room;
}
void sortArray(int* roomCount)
{
	int temp;
	for (int j = 0; j < roomCounter; j++){
		for (int k = 0; k < roomCounter; k++)
		{
			if (roomCount[k] <= roomCount[k + 1]){
				temp = roomCount[k];
				roomCount[k] = roomCount[k + 1];
				roomCount[k + 1] = temp;
			}
		}
	}

	for (int k = 0; k < roomCounter; k++)
	{
		cout << roomCount[k] << " ";
		roomCount[k] = 0;
	}
	cout << endl;
	roomCount[roomCounter] = 0;
}
