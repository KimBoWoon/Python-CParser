#include<iostream>
#include<fstream>
#include<algorithm>
using namespace std;
int count1 = 0;
void roomSize(char **room, int x, int y);
int main() {
	int num, witdh, height, x, y, i = 0;
	int sortVal[100];
	ifstream fin;
	fin.open("input.txt");
	fin >> num;  
	for (int cnt = 0; cnt < num; cnt++) {
		fin >> witdh >> height;
		char **room = new char*[height];
		for (int cnt1 = 0; cnt1 < height; cnt1++) {
			*(room + cnt1) = new char[witdh];
		}
		for (int h = 0; h < height; h++) {
			for (int w = 0; w < witdh; w++) {
				fin >> room[h][w];
			}
		}
		for (int h = 0; h < height; h++) {		
			for (int w = 0; w < witdh; w++) {
				if (room[h][w] == '.') {	
					count1 = 0;
					x = h; y = w;
					roomSize(room, x, y);		
					sortVal[i] = count1;
					i++;	
				}
			}
		}
		cout << i << endl;
		sort(sortVal, sortVal + i);
		for (int j = i-1; j >= 0; j--) {		
			cout << sortVal[j] << " ";
			sortVal[i] = 0;
		}
		i = 0;
		cout << endl;
	}
}
void roomSize(char **room, int x, int y) {		
	if (room[x][y] != '.') return;
	else {
		room[x][y] = '+';
		count1++;
		roomSize(room, x - 1, y);
		roomSize(room, x, y - 1);
		roomSize(room, x + 1, y);
		roomSize(room, x, y + 1);
	}
}