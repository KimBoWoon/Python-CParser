

#include <iostream>
#include <fstream>
#include <string>

using namespace std;

void roomsize(char room[][101], int x, int y, char dot, int count, int croom[])
{
	if(room[x][y] == '+') return;
	if(room[x][y] == dot) {
		croom[count]++;
		room[x][y] = '+';
		roomsize(room, x-1, y, dot, count, croom);
		roomsize(room, x+1, y, dot, count, croom);
		roomsize(room, x, y-1, dot, count, croom);
		roomsize(room, x, y+1, dot, count, croom);
	}
}
void sortRoom(int croom[], int size)
{
	int i,j, temp;
	for(i=0; i<size-1; i++) {
		for(j=1; j<(size-i); j++) {
			if(croom[j]<croom[j+1]) {
				temp=croom[j];
				croom[j]=croom[j+1];
				croom[j+1]=temp;
			}
		}
	}
}
int main(void) 
{
	int test, i, j, k, m, n;
	ifstream file;
	file.open("input.txt"); 
	file >> test;

	for(i=0; i<test; i++) 
	{
		int count=0;
		int croom[101]={0};
		char room[101][101]={0};
		file >> m >> n;
		for(j=0; j<n; j++) {
			for(k=0; k<m; k++) {		
				file >> room[j][k];	
			}
		}
		for(j=0; j<n; j++) {
			for(k=0; k<m; k++) {	
				if(room[j][k]=='.') count++;
				roomsize(room, j, k, '.', count, croom);
			}
		}
		printf("%d\n", count);
		sortRoom(croom, count);
		for(j=1; j<=count; j++) printf("%d ", croom[j]);
		printf("\n");
	}
	return 0;
}