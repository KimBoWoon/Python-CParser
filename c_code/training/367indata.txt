
#include <iostream>
#include <fstream>
using namespace std;
void search(char str[][100], int x, int y,char count)
{
	if (str[x][y] == '.'){
		str[x][y] = count;
	}
	if (str[x][y + 1] == '.'){
		str[x][y + 1] == count;
		search(str, x, y + 1, count);
	}
	if (str[x + 1][y] == '.'){
		str[x + 1][y] == count;
		search(str, x + 1, y, count);
	}
	if (str[x - 1][y] == '.'){
		str[x - 1][y] = count;
		search(str,x - 1, y,count);
	}
	if (str[x][y - 1] == '.'){
		str[x][y - 1] = count;
		search(str,x, y - 1,count);
	}
}
int main(){
	ifstream in;
	in.open("input.txt");
	int n, h, w, count, num[500], result,cnum;
	char room[100][100];
	in >> n;
	for (int i = 0; i < n; i++){
		in >> h >> w;
		for (int j = 0; j < w; j++){
			for (int k = 0; k < h; k++){
				in >> room[j][k];
			}
		}
		count = 49;
		for (int j = 1; j < w; j++){
			for (int k = 1; k < h; k++){
				if (room[j][k] != '.')
					continue;
				else if (room[j][k] == '.'){
					search(room, j, k, count);
					count++;
				}
			}
		}
		for (int p = 0; p < 500; p++)
			num[p] = 0;
		for (int j = 0; j < w; j++){
			for (int k = 0; k < h; k++){
				if (room[j][k] != '+'){
					result = room[j][k] - 49;
					num[result]++;
				}
			}
		}
		for (int j = 0; j < count - 49; j++){
			for (int k = 0; k < count - 49; k++){
				if (num[j] >num[k]){
					cnum = num[k];
					num[k] = num[j];
					num[j] = cnum;
				}
			}
		}
		cout << count - 49 << endl;
		for (int j = 0; j < count - 49; j++){
			cout << num[j] << " ";
		}
		cout << endl;
	}
	return 0;
}
