#include <iostream>
#include <fstream>
#include <algorithm>
#include <functional>
using namespace std;

char room[100][100];

int room_size(int x, int y) {
	if (room[x][y] != '.')	return 0;
	
	room[x][y] = 'o';
	int temp = 1;

	temp += room_size(x, y - 1);	
	temp += room_size(x + 1, y);	
	temp += room_size(x, y + 1);	
	temp += room_size(x - 1, y);	
	
	return temp;
}

int main() {
	ifstream file;
	file.open("input.txt");

	int cases;
	file >> cases;

	while (cases--) {
		int col, row;
		file >> col >> row;
		for (int i = 0; i < row; i++)
			for (int j = 0; j < col; j++)
				file >> room[i][j];

		int size[100];
		int temp = 0;
		for (int i = 1; i < row - 1; i++) {
			for (int j = 1; j < col - 1; j++) {
				int foo = room_size(i, j);

				if (foo)	size[temp++] = foo;
			}
		}
		sort(size, size + temp, greater<int>());
		cout << temp << endl;
		for (int i = 0; i < temp; i++) {
			cout << size[i] << " ";
		}
		cout << endl;
	}

	return 1;
}