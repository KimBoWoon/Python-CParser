#include <stdio.h>
#include <stdlib.h>

int Arr1[101][101], Arr2[101][101], Arr3[101][101][2][201];

int main()
{
	int T, M, N, L, G;
	int i, j, k, l;
	int temp;
	int iter;

	FILE *fp = fopen("input.txt", "r");

	int numTestCases = 0;	

	fscanf(fp, "%d", &numTestCases);	

	for (iter = 0; iter < numTestCases; iter++)
	{

		fscanf(fp, "%d %d %d %d", &N, &M, &L, &G);
		for (i = 1; i <= N; i++)
		{
			for (j = 1; j < M; j++)
			{
				fscanf(fp, "%d", Arr1[i] + j);
			}
		}
		for (i = 1; i < N; i++)
		{
			for (j = 1; j <= M; j++)
			{
				fscanf(fp, "%d", Arr2[i] + j);
			}
		}

		for (i = 1; i <= N; i++)
		{
			for (j = 1; j <= M; j++)
			{
				for (k = 0; k < 2; k++)
				{
					for (l = 0; l < 201; l++) Arr3[i][j][k][l] = G + 1;
					Arr3[1][1][0][0] = 0;
					Arr3[1][1][1][0] = 0;
				}
			}
		}


		int temp = 10000000;

		for (i = 1; i <= N; i++)
		{
			for (j = 1; j <= M; j++)
			{

				for (l = 0; l < 201; l++)
				{
					for (k = 0; k<2; k++){
						if (Arr3[i][j][k][l] <= G)
						{
							if (i == N && j == M){
								if (temp > l) 
									temp = l;
							}
							if (l < 200 && Arr3[i][j][!k][l + 1] > Arr3[i][j][k][l])
								Arr3[i][j][!k][l + 1] = Arr3[i][j][k][l];
							if (k)
							{
								if (j < M && Arr3[i][j + 1][k][l] > Arr3[i][j][k][l] + Arr1[i][j])
									Arr3[i][j + 1][k][l] = Arr3[i][j][k][l] + Arr1[i][j];
							}
							else
							{
								if (i < N && Arr3[i + 1][j][k][l] > Arr3[i][j][k][l] + Arr2[i][j])
									Arr3[i + 1][j][k][l] = Arr3[i][j][k][l] + Arr2[i][j];
							}
						}
					}
				}
			}
		}
		if (temp < 10000000)
			printf("%d\n", (N + M - 2)*L + temp);

		else
			printf("-1\n");
	}
	fclose(fp);
}

