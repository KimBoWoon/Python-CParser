
#include<iostream>
#include<fstream>
#define MAX 101

using namespace std;

int h, w, cnt, size[MAX];
char map[MAX][MAX];

void sort(){
	for (int i = 0; i < cnt; i++){
		for (int j = 0; j < cnt; j++){
			if (size[i]>size[j]){
				int t = size[i];
				size[i] = size[j];
				size[j] = t;
			}
		}
	}
}

void room(int y, int x){
	if (map[y][x] == '.'){
		size[cnt]++;
		map[y][x] = '+';
		if (map[y][x + 1] == '.') room(y, x + 1);
		if (map[y + 1][x] == '.') room(y + 1, x);
		if (map[y][x - 1] == '.') room(y, x - 1);
		if (map[y - 1][x] == '.') room(y - 1, x);
	}
}

int main(){
	ifstream in;
	in.open("input.txt");
	if (!in) return 1;
	
	int test_case;
	in >> test_case;
	for (int i = 0; i < test_case; i++){
		in >> w >> h;
		for (int j = 0; j < h; j++){
			for (int k = 0; k < w; k++){
				in >> map[j][k];
			}
		}
		cnt = 0;
		for (int j = 0; j < h; j++){
			for (int k = 0; k < w; k++){
				if (map[j][k] == '.'){
					room(j, k);
					cnt++;
				}
			}
		}
		sort();
		cout << cnt << endl;
		for (int j = 0; j < cnt; j++){
			cout << size[j] << " "; size[j] = 0;
		}
		cout << endl;
	}

	in.close();
	return 0;
}