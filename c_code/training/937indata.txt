
#include <iostream>
#include <fstream>

int v[1001][1001];	
int d[1001][1001];	
int c[1001];

int main() {
	int numcase,n;

	std::ifstream fin;
	fin.open("input.txt");

	if (fin.is_open() == false) {
		std::cout << "open error" << std::endl;
		return 0;
	}
	
	fin >> numcase;
	while (numcase--) {
		fin >> n;

		for (int i = 1; i <= n; i++) {
			fin >> c[i];
		}
		
		for (int i = 1; i <= n; i++) {
			v[i][i] = c[i];
		}

		for (int i = 1; i <= n - 1; i++) {
			if (v[i][i] > v[i + 1][i + 1]) {
				v[i][i + 1] = v[i][i];
				d[i][i + 1] = 0;
			}
			else {
				v[i][i + 1] = v[i+1][i+1];
				d[i][i + 1] = 1;
			}
		}

		for (int i = 2; i <= n - 1; i++)
			for (int j = 1; j + i <= n; j++) {
				int sum1, sum2;
				if (d[j + 1][j + i] == 1) {
					sum1 = v[j + 1][j + i - 1];
				}
				else {
					sum1 = v[j + 2][j + i];
				}
				if (d[j][j + i - 1] == 1) {
					sum2 = v[j][j + i - 2];
				}
				else {
					sum2 = v[j + 1][j + i - 1];
				}

				if (c[j] + sum1 > c[j+i] + sum2) {
					v[j][j + i] = c[j] + sum1;
					d[j][j + i] = 0;
				}
				else {
					v[j][j + i] = c[j+i] + sum2;
					d[j][j + i] = 1;
				}				

			}
			std::cout << v[1][n] << std::endl;
	}

	return -1;
}