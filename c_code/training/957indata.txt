
#include<iostream>
#include<fstream>
using namespace std;

int hori[101][101], verti[101][101], drive[101][101][2][201];

int main(){
	int numCase = 0, num = 0;
	int col, row, len, gas;
	
	ifstream File;
	File.open("input.txt");
	File >> numCase;

	for (int iter = 0; iter < numCase; iter++){
		File >> row >> col >> len >> gas;
		for (int i = 1; i <= row; i++) {
			for (int j = 1; j < col; j++) {
				File >> num;
				hori[i][j] = num;
			}
		}
		for (int i = 1; i < row; i++) {
			for (int j = 1; j <= col; j++) {
				File >> num;
				verti[i][j] = num;
			}
		}
		for (int i = 1; i <= row; i++) {
			for (int j = 1; j <= col; j++) {
				for (int k = 0; k < 2; k++) {
					for (int l = 0; l < 201; l++) {
						drive[i][j][k][l] = gas + 1;
					}
				}
			}
		}
		drive[1][1][0][0] = drive[1][1][1][0] = 0;
		int turn = 100000;
		for (int i = 1; i <= row; i++) {
			for (int j = 1; j <= col; j++) {
				for (int l = 0; l < 201; l++) {
					if (row <= col)
						if (l > 2 * row) break;
					else
						if (l > 2 * col) break;
					for (int k = 0; k < 2; k++){
						if (drive[i][j][k][l] <= gas){
							if (i == row && j == col){
								if (turn > l)
									turn = l;
							}
							if (l < 200 && drive[i][j][!k][l + 1] > drive[i][j][k][l])
								drive[i][j][!k][l + 1] = drive[i][j][k][l];
							if (k){
								if (j < col && drive[i][j + 1][k][l] > drive[i][j][k][l] + hori[i][j])
									drive[i][j + 1][k][l] = drive[i][j][k][l] + hori[i][j];
							}
							else{
								if (i < row && drive[i + 1][j][k][l] > drive[i][j][k][l] + verti[i][j])
									drive[i + 1][j][k][l] = drive[i][j][k][l] + verti[i][j];
							}
						}
					}
				}
			}
		}
		turn < 10000 ? cout << (row + col - 2)*len + turn << endl : cout << "-1" << endl;
	}
}