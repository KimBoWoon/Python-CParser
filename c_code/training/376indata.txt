




#include<iostream>
#include<fstream>
#include <algorithm>

void checkRoom(char **room, int x, int y, char oldroom, char newroom);
int number=0;
int main(int argc, char* argv[]){
	
	std:: ifstream is;
	is.open("input.txt"); 
	
	int times; 
	is >> times;

	for(int i = 0; i < times; i++){

		number = 0;
		int m,n;
		is>>m>>n; 

		char **room = new char*[n];
		for(int i = 0; i < n; i++)
			room[i] = new char[m];

		for(int i = 0; i < n; i ++)
			for (int j = 0; j <m; j++)
				is >> room[i][j];

		
		int num[100] ={0};
		int room_num=1;
		for(int i = 0; i < n; i ++)
			for (int j = 0; j < m; j++){
				
		checkRoom(room,i,j,'.','@');
		if(number !=0){
			
		num[room_num] = number;
		room_num++;
		}
		number = 0;
		}
				
			std::sort(num,num+room_num);
			std::cout<<room_num-1<<std::endl;
			for(int i = room_num-1; i > 0; i--)
				std::cout<<num[i]<<' ';
				
		std::cout<<std::endl;
	}

}

void checkRoom(char **room, int x, int y, char oldroom,char newroom){

	if( room[x][y] != oldroom )
		return ;

	else{
		room[x][y] = newroom;
		number++;
		checkRoom(room, x-1, y, oldroom,newroom);
		checkRoom(room, x+1, y, oldroom,newroom);
		checkRoom(room, x, y-1, oldroom,newroom);
		checkRoom(room, x, y+1, oldroom,newroom);
	}

}